{"version":3,"sources":["../../src/seed/Truncator.js"],"names":["deleteQueryBatch","db","query","resolve","snapshot","get","batchSize","size","batch","docs","forEach","doc","delete","ref","commit","process","nextTick"],"mappings":";;;;;;;AAAO,eAAeA,gBAAf,CAAgCC,EAAhC,EAAoCC,KAApC,EAA2CC,OAA3C,EAAoD;AACzD,QAAMC,QAAQ,GAAG,MAAMF,KAAK,CAACG,GAAN,EAAvB;AAEA,QAAMC,SAAS,GAAGF,QAAQ,CAACG,IAA3B;;AACA,MAAID,SAAS,KAAK,CAAlB,EAAqB;AACnB;AACAH,IAAAA,OAAO;AACP;AACD,GARwD,CAUzD;;;AACA,QAAMK,KAAK,GAAGP,EAAE,CAACO,KAAH,EAAd;AACAJ,EAAAA,QAAQ,CAACK,IAAT,CAAcC,OAAd,CAAuBC,GAAD,IAAS;AAC7BH,IAAAA,KAAK,CAACI,MAAN,CAAaD,GAAG,CAACE,GAAjB;AACD,GAFD;AAGA,QAAML,KAAK,CAACM,MAAN,EAAN,CAfyD,CAiBzD;AACA;;AACAC,EAAAA,OAAO,CAACC,QAAR,CAAiB,MAAM;AACrBhB,IAAAA,gBAAgB,CAACC,EAAD,EAAKC,KAAL,EAAYC,OAAZ,CAAhB;AACD,GAFD;AAGD","sourcesContent":["export async function deleteQueryBatch(db, query, resolve) {\n  const snapshot = await query.get();\n\n  const batchSize = snapshot.size;\n  if (batchSize === 0) {\n    // When there are no documents left, we are done\n    resolve();\n    return;\n  }\n\n  // Delete documents in a batch\n  const batch = db.batch();\n  snapshot.docs.forEach((doc) => {\n    batch.delete(doc.ref);\n  });\n  await batch.commit();\n\n  // Recurse on the next process tick, to avoid\n  // exploding the stack.\n  process.nextTick(() => {\n    deleteQueryBatch(db, query, resolve);\n  });\n}\n"],"file":"Truncator.js"}