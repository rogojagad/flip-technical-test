{"version":3,"sources":["../../src/service/CreateDisbursementService.js"],"names":["CreateDisbursementService","constructor","disbursementHttpService","DisbursementHttpService","disbursementRepository","DisbursementRepository","readBalanceService","ReadBalanceService","readUserService","ReadUserService","createOneByUserId","userId","remark","user","readOneById","balance","readOneByUserId","date","Date","User","ATTRIBUTE_NAME","disbursement","Object","Disbursement","ATTRIBUTE_CREATED_AT","ATTRIBUTE_UPDATED_AT","ATTRIBUTE_BANK_CODE","ATTRIBUTE_ACCOUNT_NUMBER","ATTRIBUTE_USER_ID","ATTRIBUTE_AMOUNT","Balance","ATTRIBUTE_STATUS","STATUS_DRAFT","ATTRIBUTE_REMARK","disbursementRecord","createOne","sendOneDisbursement","id"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AAEe,MAAMA,yBAAN,CAAgC;AAC7CC,EAAAA,WAAW,GAAG;AACZ,SAAKC,uBAAL,GAA+B,IAAIC,gCAAJ,EAA/B;AACA,SAAKC,sBAAL,GAA8B,IAAIC,+BAAJ,EAA9B;AACA,SAAKC,kBAAL,GAA0B,IAAIC,2BAAJ,EAA1B;AACA,SAAKC,eAAL,GAAuB,IAAIC,wBAAJ,EAAvB;AACD;;AAEsB,QAAjBC,iBAAiB,CAACC,MAAD,EAASC,MAAT,EAAiB;AACtC,UAAMC,IAAI,GAAG,MAAM,KAAKL,eAAL,CAAqBM,WAArB,CAAiCH,MAAjC,CAAnB;AACA,UAAMI,OAAO,GAAG,MAAM,KAAKT,kBAAL,CAAwBU,eAAxB,CAAwCL,MAAxC,CAAtB;AACA,UAAMM,IAAI,GAAG,IAAIC,IAAJ,EAAb;AACAN,IAAAA,MAAM,GAAGA,MAAM,GACXA,MADW,GAEV,gBAAeC,IAAI,CAACM,cAAKC,cAAN,CAAsB,IAAGH,IAAK,EAFtD;AAIA,UAAMI,YAAY,GAAGC,MAAM,EAA3B;AACAD,IAAAA,YAAY,CAACE,sBAAaC,oBAAd,CAAZ,GAAkD,IAAIN,IAAJ,EAAlD;AACAG,IAAAA,YAAY,CAACE,sBAAaE,oBAAd,CAAZ,GAAkD,IAAIP,IAAJ,EAAlD;AACAG,IAAAA,YAAY,CAACE,sBAAaG,mBAAd,CAAZ,GACEb,IAAI,CAACM,cAAKO,mBAAN,CADN;AAEAL,IAAAA,YAAY,CAACE,sBAAaI,wBAAd,CAAZ,GACEd,IAAI,CAACM,cAAKQ,wBAAN,CADN;AAEAN,IAAAA,YAAY,CAACE,sBAAaK,iBAAd,CAAZ,GAA+CjB,MAA/C;AACAU,IAAAA,YAAY,CAACE,sBAAaM,gBAAd,CAAZ,GACEd,OAAO,CAACe,iBAAQD,gBAAT,CADT;AAEAR,IAAAA,YAAY,CAACE,sBAAaQ,gBAAd,CAAZ,GAA8CR,sBAAaS,YAA3D;AACAX,IAAAA,YAAY,CAACE,sBAAaU,gBAAd,CAAZ,GAA8CrB,MAA9C;AAEA,UAAMsB,kBAAkB,GAAG,MAAM,KAAK9B,sBAAL,CAA4B+B,SAA5B,CAC/Bd,YAD+B,CAAjC;AAIA,SAAKnB,uBAAL,CAA6BkC,mBAA7B,CACEvB,IADF,EAEEE,OAFF,EAGEmB,kBAAkB,CAACG,EAHrB,EAIEzB,MAJF;AAOA,WAAOsB,kBAAP;AACD;;AAzC4C","sourcesContent":["import Balance from \"~src/const/Balance\";\nimport Disbursement from \"~src/const/Disbursement\";\nimport DisbursementHttpService from \"~src/service/DisbursementHttpService\";\nimport DisbursementRepository from \"~src/repository/DisbursementRepository\";\nimport ReadBalanceService from \"~src/service/ReadBalanceService\";\nimport ReadUserService from \"~src/service/ReadUserService\";\nimport User from \"~src/const/User\";\n\nexport default class CreateDisbursementService {\n  constructor() {\n    this.disbursementHttpService = new DisbursementHttpService();\n    this.disbursementRepository = new DisbursementRepository();\n    this.readBalanceService = new ReadBalanceService();\n    this.readUserService = new ReadUserService();\n  }\n\n  async createOneByUserId(userId, remark) {\n    const user = await this.readUserService.readOneById(userId);\n    const balance = await this.readBalanceService.readOneByUserId(userId);\n    const date = new Date();\n    remark = remark\n      ? remark\n      : `DISBURSEMENT ${user[User.ATTRIBUTE_NAME]} ${date}`;\n\n    const disbursement = Object();\n    disbursement[Disbursement.ATTRIBUTE_CREATED_AT] = new Date();\n    disbursement[Disbursement.ATTRIBUTE_UPDATED_AT] = new Date();\n    disbursement[Disbursement.ATTRIBUTE_BANK_CODE] =\n      user[User.ATTRIBUTE_BANK_CODE];\n    disbursement[Disbursement.ATTRIBUTE_ACCOUNT_NUMBER] =\n      user[User.ATTRIBUTE_ACCOUNT_NUMBER];\n    disbursement[Disbursement.ATTRIBUTE_USER_ID] = userId;\n    disbursement[Disbursement.ATTRIBUTE_AMOUNT] =\n      balance[Balance.ATTRIBUTE_AMOUNT];\n    disbursement[Disbursement.ATTRIBUTE_STATUS] = Disbursement.STATUS_DRAFT;\n    disbursement[Disbursement.ATTRIBUTE_REMARK] = remark;\n\n    const disbursementRecord = await this.disbursementRepository.createOne(\n      disbursement\n    );\n\n    this.disbursementHttpService.sendOneDisbursement(\n      user,\n      balance,\n      disbursementRecord.id,\n      remark\n    );\n\n    return disbursementRecord;\n  }\n}\n"],"file":"CreateDisbursementService.js"}